---
title: James Keats - Context Behaviors
layout: default
picture1: "/assets/img/portfolio/contextbhvr/cover.png"
---
<div class="elementTextWrapper">
    <h1>{{site.data.portfolio.contextbhvr.details.title}}</h1>
</div>
<div class="elementTextWrapper">
    <h2>{{site.data.portfolio.contextbhvr.details.byline}}</h2>
</div>
<div class="contentBlock">
    <div class="elementTextWrapper">
        <p>{{site.data.portfolio.contextbhvr.details.intro}}</p>
    </div>
    <div class="elementTextWrapper" style="text-align:center;">
        <img src={{ page.picture1 }} style="width:90%; max-width:600px;">
    </div>
    <div class="elementTextWrapper">
        <p>{{site.data.portfolio.contextbhvr.details.lede}}</p>
    </div>
    <div class="elementTextWrapper">
        <h3>The General Idea</h3>
    </div>
    <div class="elementTextWrapper">
        <p>{{site.data.portfolio.contextbhvr.details.p01}}</p>
    </div>
    <div class="elementTextWrapper">
        <div>
            <p style="text-align: center;"><span>
                    <font size="3">{{site.data.portfolio.contextbhvr.details.q02}}</font>
                </span></p>
        </div>
    </div>
    <div class="elementTextWrapper">
        <p>{{site.data.portfolio.contextbhvr.details.p03}}</p>
    </div>
    <div class="elementTextWrapper" style="text-align:center;">
        <img src={{site.data.portfolio.contextbhvr.details.i04}} style="width:90%; max-width:500px">
    </div>
    <div class="elementTextWrapper">
        <p>{{site.data.portfolio.contextbhvr.details.p05}}</p>
    </div>
    <div class="elementTextWrapper" style="text-align:center;">
        <img src={{site.data.portfolio.contextbhvr.details.i06}} style="width:90%; max-width:550px">
    </div>
    <div class="elementTextWrapper">
        <p>{{site.data.portfolio.contextbhvr.details.p07}}</p>
    </div>
    <div class="elementTextWrapper">
        <p>{{site.data.portfolio.contextbhvr.details.p08}}</p>
    </div>
    <div class="elementTextWrapper">
        <h3>C++ Implementation</h3>
    </div>
    <div class="elementTextWrapper">
        <p>{{site.data.portfolio.contextbhvr.details.p09}}</p>
    </div>
    <div class="elementTextWrapper">
        <p>{{site.data.portfolio.contextbhvr.details.p10}}</p>
    </div>

    <div class="elementTextWrapper">
{% highlight cpp %}
void ContextDecisionMaker::update()
{
        //Get the data we need.
        Unit* owner = gpGame->getUnitManager()->getUnit(mOwnerID);
        PhysicsData data = owner->getPhysicsComponent()->getData();
        Vector2 ownerPos = owner->getCurrentPosition();
    
        //Create maps and initialize completely to zero.
        context_map_t dangerMap(NUMBER_OF_DIRECTIONS, 0.0f);
        context_map_t interestMap(NUMBER_OF_DIRECTIONS, 0.0f);
        
        //Fill danger map.
        fillDangerMap(dangerMap, ownerPos);
    
        //Use the danger map to fill only the unblocked slots in the interest map.
        fillInterestMap(dangerMap, interestMap, ownerPos);
    
        //Get the best direction to go in.
        Direction strongestInterest = chooseBestDirection(interestMap);
    
        if (strongestInterest == Direction::NONE)
        {
                data.acc = data.vel * -5.0f; //slow down.
        }
        else
        {
                Direction leftDir = strongestInterest.getDirToLeft();
                Direction rightDir = strongestInterest.getDirToRight();
    
                //Blend the strongest direction and the two directions next to it.
                Vector2 blendedDir =
                            DIRECTIONS[strongestInterest] +
                            DIRECTIONS[leftDir] * interestMap[leftDir] +
                            DIRECTIONS[rightDir] * interestMap[rightDir];
    
                blendedDir.normalize();
    
                //Accelerate in that direction, adjusting for our current velocity.
                data.acc =
                        (blendedDir + (blendedDir - data.vel.normalized())) * data.maxAcc;
        }
    
        mData = data;
}
{% endhighlight %}
    </div>

    <div class="elementTextWrapper">
        <p>{{site.data.portfolio.contextbhvr.details.p11}}</p>
    </div>
    <div class="elementTextWrapper" style="text-align: center">
        <iframe class="video-container"
            src="https://player.vimeo.com/video/194261930?color=ff9933&amp;byline=0&amp;title=0&amp;portrait=0"
            allowfullscreen="true" width="100%" frameborder="0"></iframe>
    </div>
    <div class="elementTextWrapper">
        <p>{{site.data.portfolio.contextbhvr.details.p12}}</p>
    </div>
    <div class="elementTextWrapper" style="text-align: center">
        <iframe class="video-container"
            src="https://player.vimeo.com/video/194261921?color=ff9933&amp;byline=0&amp;title=0&amp;portrait=0"
            allowfullscreen="true" width="100%" frameborder="0"></iframe>
    </div>
    <div class="elementTextWrapper">
        <p>{{site.data.portfolio.contextbhvr.details.p13}}</p>
    </div>
    <div class="elementTextWrapper" style="text-align: center">
        <iframe class="video-container"
            src="https://player.vimeo.com/video/194258358?color=ff9933&amp;byline=0&amp;title=0&amp;portrait=0"
            allowfullscreen="true" width="100%" frameborder="0"></iframe>
    </div>
    <div class="elementTextWrapper">
        <p>{{site.data.portfolio.contextbhvr.details.p14}}</p>
    </div>
    <div class="elementTextWrapper">
        <p>{{site.data.portfolio.contextbhvr.details.p15}}</p>
    </div>
    <div class="elementTextWrapper">
        <p>{{site.data.portfolio.contextbhvr.details.p16}}</p>
    </div>
    <div class="elementTextWrapper">
        <h3><a href="/assets/bin/jameskeats_context_demo.zip">Download the Context Behavior demo now!</a></h3>
    </div>
    <div class="elementTextWrapper">
        <p>{{site.data.portfolio.contextbhvr.details.p17}}</p>
    </div>
    <div class="elementTextWrapper" style="text-align: center">
        <iframe class="video-container"
            src="https://player.vimeo.com/video/194354231?color=ff9933&amp;byline=0&amp;title=0&amp;portrait=0"
            allowfullscreen="true" width="100%" frameborder="0"></iframe>
    </div>
</div>