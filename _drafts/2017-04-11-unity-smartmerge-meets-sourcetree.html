---
title: James Keats - Game Programmer
layout: default
---
<div class="contentBlock">
    <h2 class="elementTextWrapper">Unity's SmartMerge Meets SourceTree</h2>
    <div>
        <div class="elementTextWrapper">
            <div>
                <p>Before I begin, I want to give credit to whoever wrote the blog post that used to be located at the
                    following link: <span><a
                            href="http://www.nikumangames.com/dev-blog/unity-and-sourcetree-and-unityyamlmerge-exe-oh-my/"
                            target="_blank"
                            title="Unity and SourceTree and UnityYamlMerge Oh My!">http://www.nikumangames.com/dev-blog/unity-and-sourcetree-and-unityyamlmerge-exe-oh-my/</a></span>
                </p>
            </div>
        </div>
        <div class="elementTextWrapper">
            <div>
                <p><span>The only reason I'm writing this post is that it looks like their website is down and isn't
                        available in the Wayback Machine. So thank you, mysterious vanishing developer(s)! Major credit
                        also goes to Tim Pettersen (<a href="https://twitter.com/kannonboy" rel="nofollow"
                            target="_blank">@kannonboy</a>) for his GDC 2017 talk on incorporating Unity with git which
                        is what got me started down this path.</span></p>
            </div>
        </div>
        <div class="elementTextWrapper">
            <div>
                <p>This guide is aimed at developers on Windows. The setup process for OSX will be similar but some of
                    the specifics about things like file paths will be different.<br></p>
            </div>
        </div>
        <div class="elementTextWrapper">
            <div>
                <p>The basic point of this post is as follows: git is an incredible piece of version control. I think it
                    blows the rest out of the water. If you haven't, you should check out Tim Pettersen's full <a
                        href="http://www.gamasutra.com/blogs/TimPettersen/20161206/286981/The_complete_guide_to_Unity__Git.php"
                        rel="nofollow" target="_blank" title="The complete guide to Unity &amp; Git">guide to setting up
                        git with Unity</a>. SourceTree is also a great piece of software that makes git more accessible
                    to a lot more people. Unfortunately, getting all of the great version control tools with Unity and
                    git to work well with SourceTree isn't totally clear-cut. The following is a guide on setting up
                    SmartMerge with SourceTree, and assumes you've already followed the guide that Tim provided
                    (although you can skip the steps about handling large Unity assets if you're not working with a
                    server that supports it; for all my Champlain friends, unfortunately Pineapple does not have git lfs
                    support yet).<br></p>
            </div>
        </div>
        <div class="elementTextWrapper">
            <div>
                <h4>Setting Up SmartMerge in SourceTree</h4>
            </div>
        </div>
        <div class="elementTextWrapper">
            <div>
                <p>Unity has a guide for setting up their YAML Merge tool with SourceTree available <a
                        href="https://docs.unity3d.com/Manual/SmartMerge.html" target="_blank"
                        title="Unity - Manual: Smart Merge">on their website</a>, but here's what they say to do:<br>
                </p>
            </div>
        </div>
        <div class="elementTextWrapper">
            <div>
                <ol>
                    <li>Go to Tools-&gt; Options -&gt; Diff</li>
                    <li>Under the "External Diff / Merge" heading, change Merge Tool to Custom.</li>
                    <li>In the <b>Merge Command</b> field, type the full path to the UnityYAMLMerge executable. <br>(On
                        Windows,this will generally be <i><span>C:/Program
                                Files/Unity/Editor/Data/Tools</span>/</i><span><i>UnityYAMLMerge.exe</i>)</span></li>
                    <li><span>In the <b>Arguments </b>field, <code></code><span><code></code></span>type <i>merge -p
                                $BASE $REMOTE $LOCAL $MERGED</i><br></span></li>
                </ol>
            </div>
        </div>
        <div class="elementTextWrapper">
            <div>
                <h4>Setting Up <span>UnityYAMLMerge</span></h4>
            </div>
        </div>
        <div class="elementTextWrapper">
            <div>
                <p>SmartMerge needs a merge tool to fall back on. You should probably use a visual merge tool such as
                    P4Merge from Perforce. You can <a href="https://www.perforce.com/downloads/visual-merge-tool"
                        rel="nofollow" target="_blank">download that here</a>. Note that you don't actually need to
                    register to download, and that when installing you can deselect everything except P4Merge.<br></p>
            </div>
        </div>
        <div class="elementTextWrapper">
            <div>
                <ol>
                    <li>Find the following file: <span><i>[Unity Install
                                Directory]</i><span><i><span>/Editor/Data/Tools</span>/<span>mergespecfile.txt</span></i></span></span><br>
                    </li>
                    <li>Within this file, locate the two lines starting with "unity use" and "prefab use".</li>
                    <li>If you used P4Merge and installed to the default location, change them to this
                        <b>exactly</b>:<br><span><i><span>unity use "%programs%\Perforce\p4merge" "%b" "%r" "%l"
                                    "%d"</span><br><span>prefab use "%programs%\Perforce\p4merge" "%b" "%r" "%l"
                                    "%d"</span></i></span></li>
                </ol>
            </div>
        </div>
        <div class="elementTextWrapper">
            <div>
                <p>If you're using something other than P4Merge, you will need to determine the correct path and order
                    of the command line arguments. Note that these lines <i>should</i> be the same on OSX but I've only
                    tested on Windows.<br></p>
            </div>
        </div>
        <div class="elementTextWrapper">
            <div>
                <h4>Other Tips<br></h4>
            </div>
        </div>
        <div class="elementTextWrapper">
            <div>
                <p>In his <a
                        href="http://www.gamasutra.com/blogs/TimPettersen/20161206/286981/The_complete_guide_to_Unity__Git.php"
                        rel="nofollow" target="_blank"
                        title="Gamasutra: Time Pettersen's Blog - The complete guide to Unity &amp; Git">Gamasutra
                        post</a> that summarizes his GDC talk, Tim Pettersen also recommends turning off "keepBackup"
                    for your merge tool, which will help keep your working directory clean. The easiest way that I've
                    found to do this in SourceTree is to open the Terminal and enter the following: <i><span>git config
                            --global mergetool.keepBackup false.</span></i><span></span><br></p>
            </div>
        </div>
        <div class="elementTextWrapper">
            <div>
                <p>If you've done everything right, the next time you have a merge conflict with Unity scenes or
                    prefabs, you should be able to right click on the file in <b>File Status</b> in SourceTree, go to
                    Resolve Conflicts, and then Launch External Merge Tool. If the conflict is a relatively simple one,
                    SmartMerge will be able to determine the correct course of action and merge the data. If both
                    versions have edits to the same data, it will launch P4Merge (or whatever your external merge tool
                    of choice is) which will then require you to manually choose which version of the component you want
                    to keep.<br></p>
            </div>
        </div>
        <div class="elementTextWrapper">
            <div>
                <p>Hopefully you found this guide helpful. Have fun with Unity and git!<br></p>
            </div>
        </div>
    </div>
</div>